<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>reproducibility - application • cornet</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="reproducibility - application">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cornet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../articles/vignette.html">vignette</a>
</li>
<li>
  <a href="../articles/article.html">article</a>
</li>
<li>
  <a href="../articles/simulation.html">simulation</a>
</li>
<li>
  <a href="../articles/application.html">application</a>
</li>
<li>
  <a href="../news/index.html">news</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rauschenberger/cornet">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://cran.r-project.org/package=cornet">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>reproducibility - application</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rauschenberger/cornet/blob/master/vignettes/application.Rmd"><code>vignettes/application.Rmd</code></a></small>
      <div class="hidden name"><code>application.Rmd</code></div>

    </div>

    
    
<p>This script requires that the working directory includes the folders “data”, “results”, and “manuscript”, with the files “PPMI_Baseline_Data_02Jul2018.csv”, “PPMI_Year_1-3_Data_02Jul2018.csv” and “PPMI_Data_Dictionary_for_Baseline_Dataset_Jul2018.csv” in the folder “data”. We obtained our results using R 3.6.1 (2019-07-05) with cornet 0.0.3 (2019-10-02) on a local machine (x86_64-w64-mingw32/x64, Windows 10 x64).</p>
<div id="processing" class="section level1">
<h1 class="hasAnchor">
<a href="#processing" class="anchor"></a>Processing</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># features</span></a>
<a class="sourceLine" id="cb1-2" title="2">X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"data/PPMI_Baseline_Data_02Jul2018.csv"</span>,<span class="dt">row.names=</span><span class="st">"PATNO"</span>,<span class="dt">na.strings=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"."</span>,<span class="st">""</span>))</a>
<a class="sourceLine" id="cb1-3" title="3">X &lt;-<span class="st"> </span>X[X<span class="op">$</span>APPRDX<span class="op">==</span><span class="dv">1</span>,] <span class="co"># Parkinson's disease</span></a>
<a class="sourceLine" id="cb1-4" title="4">X[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SITE"</span>,<span class="st">"APPRDX"</span>,<span class="st">"EVENT_ID"</span>,<span class="st">"symptom5_comment"</span>)] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(X)) <span class="co"># proportion missingness</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#x &lt;- mice::complete(data=mice::mice(X,m=10,maxit=5,method="pmm",seed=1),action="all") # low-dimensional</span></a>
<a class="sourceLine" id="cb1-7" title="7">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="dv">10</span>),<span class="cf">function</span>(x) missRanger<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/missRanger/man/missRanger.html">missRanger</a></span>(<span class="dt">data=</span>X,<span class="dt">pmm.k=</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1-8" title="8">        <span class="dt">num.trees=</span><span class="dv">100</span>,<span class="dt">verbose=</span><span class="dv">0</span>,<span class="dt">seed=</span><span class="dv">1</span>)) <span class="co"># high-dimensional</span></a>
<a class="sourceLine" id="cb1-9" title="9">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(x,<span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span>(<span class="op">~</span>.<span class="op">-</span><span class="dv">1</span>,<span class="dt">data=</span>x))</a>
<a class="sourceLine" id="cb1-10" title="10"></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co"># outcome</span></a>
<a class="sourceLine" id="cb1-12" title="12">Y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"data/PPMI_Year_1-3_Data_02Jul2018.csv"</span>,<span class="dt">na.strings=</span><span class="st">"."</span>)</a>
<a class="sourceLine" id="cb1-13" title="13">Y &lt;-<span class="st"> </span>Y[Y<span class="op">$</span>APPRDX<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>Y<span class="op">$</span>EVENT_ID <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"V04"</span>,<span class="st">"V06"</span>,<span class="st">"V08"</span>),]</a>
<a class="sourceLine" id="cb1-14" title="14">Y &lt;-<span class="st"> </span>Y[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EVENT_ID"</span>,<span class="st">"PATNO"</span>,<span class="st">"moca"</span>)]</a>
<a class="sourceLine" id="cb1-15" title="15">Y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span>(Y,<span class="dt">idvar=</span><span class="st">"PATNO"</span>,<span class="dt">timevar=</span><span class="st">"EVENT_ID"</span>,<span class="dt">direction=</span><span class="st">"wide"</span>)</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(Y) &lt;-<span class="st"> </span>Y<span class="op">$</span>PATNO; Y<span class="op">$</span>PATNO &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb1-17" title="17"></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># overlap</span></a>
<a class="sourceLine" id="cb1-19" title="19">names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(X),<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(Y))</a>
<a class="sourceLine" id="cb1-20" title="20">Y &lt;-<span class="st"> </span>Y[names,]; x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(x,<span class="cf">function</span>(x) x[names,])</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(Y,x,<span class="dt">file=</span><span class="st">"data/processed_data.RData"</span>)</a>
<a class="sourceLine" id="cb1-22" title="22"><span class="kw"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span>(<span class="dt">text=</span><span class="kw"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span>(utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>(),<span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</a>
<a class="sourceLine" id="cb1-23" title="23">        sessioninfo<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span>()),<span class="dt">con=</span><span class="st">"data/info_data.txt"</span>)</a>
<a class="sourceLine" id="cb1-24" title="24"></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="co"># dictionary</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</a>
<a class="sourceLine" id="cb1-27" title="27">info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"data/PPMI_Data_Dictionary_for_Baseline_Dataset_Jul2018.csv"</span>,<span class="dt">nrows=</span><span class="dv">238</span>)</a>
<a class="sourceLine" id="cb1-28" title="28">info &lt;-<span class="st"> </span>info[<span class="op">!</span>info<span class="op">$</span>Variable <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">"PATNO"</span>,<span class="st">"SITE"</span>,<span class="st">"APPRDX"</span>,<span class="st">"EVENT_ID"</span>,<span class="st">"symptom5_comment"</span>),]</a>
<a class="sourceLine" id="cb1-29" title="29">info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">textit{"</span>,info<span class="op">$</span>Variable,<span class="st">"}: "</span>,info<span class="op">$</span>Description),<span class="dt">collapse=</span><span class="st">"; "</span>)</a>
<a class="sourceLine" id="cb1-30" title="30">info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">" </span><span class="ch">\\</span><span class="st">(OFF</span><span class="ch">\\</span><span class="st">)"</span>,<span class="dt">replacement=</span><span class="st">""</span>,<span class="dt">x=</span>info)</a>
<a class="sourceLine" id="cb1-31" title="31">info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"_"</span>,<span class="dt">replacement=</span><span class="st">"</span><span class="ch">\\</span><span class="st">_"</span>,<span class="dt">x=</span>info,<span class="dt">fixed=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-32" title="32">info &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"&amp;"</span>,<span class="dt">replacement=</span><span class="st">"</span><span class="ch">\\\\</span><span class="st">&amp;"</span>,<span class="dt">x=</span>info)</a>
<a class="sourceLine" id="cb1-33" title="33"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(info)</a></code></pre></div>
</div>
<div id="analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis" class="anchor"></a>Analysis</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"data/processed_data.RData"</span>,<span class="dt">verbose=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(Y)) <span class="co"># sample size</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span>(Y<span class="op">&lt;</span><span class="fl">25.5</span>,<span class="dt">na.rm=</span><span class="ot">TRUE</span>),<span class="dv">1</span>) <span class="co"># proportion impairment</span></a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># --- Cross-validating models. ---</span></a>
<a class="sourceLine" id="cb2-7" title="7">names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lasso"</span>,<span class="st">"ridge"</span>),<span class="dt">each=</span><span class="dv">3</span>),<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="dv">3</span>)) <span class="co"># change to 3!</span></a>
<a class="sourceLine" id="cb2-8" title="8">loss &lt;-<span class="st"> </span>fit &lt;-<span class="st"> </span>pval &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(x)){</a>
<a class="sourceLine" id="cb2-10" title="10">  loss[[i]] &lt;-<span class="st"> </span>fit[[i]] &lt;-<span class="st"> </span>pval[[i]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"i ="</span>,i,<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(names)){</a>
<a class="sourceLine" id="cb2-13" title="13">      <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"j ="</span>,j,<span class="st">" "</span>)</a>
<a class="sourceLine" id="cb2-14" title="14">      alpha &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">*</span>(<span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(names[j],<span class="dt">start=</span><span class="dv">1</span>,<span class="dt">stop=</span><span class="dv">5</span>)<span class="op">==</span><span class="st">"lasso"</span>)</a>
<a class="sourceLine" id="cb2-15" title="15">      index &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(names[j],<span class="dt">start=</span><span class="dv">6</span>,<span class="dt">stop=</span><span class="dv">6</span>))</a>
<a class="sourceLine" id="cb2-16" title="16">      y &lt;-<span class="st"> </span>Y[,index]</a>
<a class="sourceLine" id="cb2-17" title="17">      cond &lt;-<span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(y)</a>
<a class="sourceLine" id="cb2-18" title="18">      <span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(i)</a>
<a class="sourceLine" id="cb2-19" title="19">      loss[[i]][[names[j]]] &lt;-<span class="st"> </span>cornet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cornet/man/cv.cornet.html">cv.cornet</a></span>(<span class="dt">y=</span>y[cond],<span class="dt">cutoff=</span><span class="fl">25.5</span>,</a>
<a class="sourceLine" id="cb2-20" title="20">                                  <span class="dt">X=</span>x[[i]][cond,],<span class="dt">alpha=</span>alpha)</a>
<a class="sourceLine" id="cb2-21" title="21">      <span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(i)</a>
<a class="sourceLine" id="cb2-22" title="22">      fit[[i]][[names[j]]] &lt;-<span class="st"> </span>cornet<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/cornet/man/cornet.html">cornet</a></span>(<span class="dt">y=</span>y[cond],<span class="dt">cutoff=</span><span class="fl">25.5</span>,</a>
<a class="sourceLine" id="cb2-23" title="23">                                  <span class="dt">X=</span>x[[i]][cond,],<span class="dt">alpha=</span>alpha)</a>
<a class="sourceLine" id="cb2-24" title="24">      <span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(i)</a>
<a class="sourceLine" id="cb2-25" title="25">      pval[[i]][[names[j]]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(<span class="dt">n=</span><span class="dv">50</span>,<span class="dt">expr=</span>cornet<span class="op">:::</span><span class="kw"><a href="../reference/dot-test.html">.test</a></span>(<span class="dt">y=</span>y[cond],<span class="dt">cutoff=</span><span class="fl">25.5</span>,<span class="dt">X=</span>x[[i]][cond,],<span class="dt">alpha=</span>alpha)))</a>
<a class="sourceLine" id="cb2-26" title="26">    }</a>
<a class="sourceLine" id="cb2-27" title="27">    <span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb2-28" title="28">}</a>
<a class="sourceLine" id="cb2-29" title="29"></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(loss,fit,pval,<span class="dt">file=</span><span class="st">"results/application.RData"</span>)</a>
<a class="sourceLine" id="cb2-31" title="31"><span class="kw"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span>(<span class="dt">text=</span><span class="kw"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span>(utils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>(),<span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>),</a>
<a class="sourceLine" id="cb2-32" title="32">        sessioninfo<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/sessioninfo/man/session_info.html">session_info</a></span>()),<span class="dt">con=</span><span class="st">"results/info_app.txt"</span>)</a></code></pre></div>
</div>
<div id="results" class="section level1">
<h1 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"results/application.RData"</span>,<span class="dt">verbose=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"lasso"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"ridge"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb3-4" title="4">frame &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">row.names=</span>names)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> names){</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="co"># deviance</span></a>
<a class="sourceLine" id="cb3-8" title="8">  dev &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(loss,<span class="cf">function</span>(x) x[[i]]<span class="op">$</span>deviance)))</a>
<a class="sourceLine" id="cb3-9" title="9">  dec &lt;-<span class="st"> </span>(dev<span class="op">$</span>combined<span class="op">-</span>dev<span class="op">$</span>binomial)<span class="op">/</span>dev<span class="op">$</span>binomial</a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="co"># change in percent</span></a>
<a class="sourceLine" id="cb3-11" title="11">  frame[i,<span class="st">"dev.min"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(dec),<span class="dt">digits=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-12" title="12">  frame[i,<span class="st">"dev.max"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="dv">100</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(dec),<span class="dt">digits=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-13" title="13">  </a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="co"># proportion with improvement</span></a>
<a class="sourceLine" id="cb3-15" title="15">  frame[i,<span class="st">"dev.num"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(dev<span class="op">$</span>combined <span class="op">&lt;</span><span class="st"> </span>dev<span class="op">$</span>binomial)</a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="co"># significance based on multi-split</span></a>
<a class="sourceLine" id="cb3-18" title="18">  pvalue &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(pval,<span class="cf">function</span>(x) x[[i]])</a>
<a class="sourceLine" id="cb3-19" title="19">  frame[i,<span class="st">"pval.min"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">signif</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(pvalue),<span class="dt">digits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-20" title="20">  frame[i,<span class="st">"pval.max"</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">signif</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(pvalue),<span class="dt">digits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="co">#frame[i,"pval.prop"] &lt;- round(mean(pvalue&lt;0.05),digits=2)</span></a>
<a class="sourceLine" id="cb3-22" title="22"></a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="co"># quantiles weight parameter</span></a>
<a class="sourceLine" id="cb3-24" title="24">  q &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(fit,<span class="cf">function</span>(x) x[[i]]<span class="op">$</span>pi.min),<span class="dt">probs=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>)),<span class="dt">digits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-25" title="25">  frame[i,<span class="st">"pi.min"</span>] &lt;-<span class="st"> </span>q[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-26" title="26">  frame[i,<span class="st">"pi.med"</span>] &lt;-<span class="st"> </span>q[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-27" title="27">  frame[i,<span class="st">"pi.max"</span>] &lt;-<span class="st"> </span>q[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb3-28" title="28">  </a>
<a class="sourceLine" id="cb3-29" title="29">  <span class="co"># quantiles scale parameter</span></a>
<a class="sourceLine" id="cb3-30" title="30">  q &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(fit,<span class="cf">function</span>(x) x[[i]]<span class="op">$</span>sigma.min),<span class="dt">probs=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>)),<span class="dt">digits=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-31" title="31">  frame[i,<span class="st">"sd.min"</span>] &lt;-<span class="st"> </span>q[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb3-32" title="32">  frame[i,<span class="st">"sd.med"</span>] &lt;-<span class="st"> </span>q[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-33" title="33">  frame[i,<span class="st">"sd.max"</span>] &lt;-<span class="st"> </span>q[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb3-34" title="34">}</a>
<a class="sourceLine" id="cb3-35" title="35"></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co"># presentation</span></a>
<a class="sourceLine" id="cb3-37" title="37"></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(frame),<span class="dt">start=</span><span class="dv">1</span>,<span class="dt">stop=</span><span class="dv">5</span>),<span class="st">" "</span>,</a>
<a class="sourceLine" id="cb3-39" title="39">                          <span class="kw"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(frame),<span class="dt">start=</span><span class="dv">6</span>,<span class="dt">stop=</span><span class="dv">6</span>))</a>
<a class="sourceLine" id="cb3-40" title="40"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"dev."</span>,<span class="dt">replacement=</span><span class="st">"</span><span class="ch">\\\\</span><span class="st">delta_{</span><span class="ch">\\\\</span><span class="st">text{"</span>,<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame))</a>
<a class="sourceLine" id="cb3-41" title="41"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"pval."</span>,<span class="dt">replacement=</span><span class="st">"p_{</span><span class="ch">\\\\</span><span class="st">text{"</span>,<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame))</a>
<a class="sourceLine" id="cb3-42" title="42"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"pi."</span>,<span class="dt">replacement=</span><span class="st">"</span><span class="ch">\\\\</span><span class="st">pi_{</span><span class="ch">\\\\</span><span class="st">text{"</span>,<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame))</a>
<a class="sourceLine" id="cb3-43" title="43"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="dt">pattern=</span><span class="st">"sd."</span>,<span class="dt">replacement=</span><span class="st">"</span><span class="ch">\\\\</span><span class="st">sigma_{</span><span class="ch">\\\\</span><span class="st">text{"</span>,<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame))</a>
<a class="sourceLine" id="cb3-44" title="44"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"$"</span>,<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame),<span class="st">"}}$"</span>)</a>
<a class="sourceLine" id="cb3-45" title="45"></a>
<a class="sourceLine" id="cb3-46" title="46">digits &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">+</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span><span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="dt">pattern=</span><span class="st">"delta_|p_"</span>,<span class="dt">x=</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(frame))) <span class="co"># was "p_"</span></a>
<a class="sourceLine" id="cb3-47" title="47">xtable &lt;-<span class="st"> </span>xtable<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/xtable/man/xtable.html">xtable</a></span>(frame,<span class="dt">digits=</span>digits)</a>
<a class="sourceLine" id="cb3-48" title="48">xtable<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/xtable/man/print.xtable.html">print.xtable</a></span>(xtable,<span class="dt">include.rownames=</span><span class="ot">TRUE</span>,<span class="dt">sanitize.text.function=</span><span class="cf">function</span>(x) x)</a></code></pre></div>
</div>
<div id="figures" class="section level1">
<h1 class="hasAnchor">
<a href="#figures" class="anchor"></a>Figures</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/load.html">load</a></span>(<span class="st">"results/application.RData"</span>,<span class="dt">verbose=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">sum &lt;-<span class="st"> </span>fit[[<span class="dv">1</span>]]<span class="op">$</span>lasso1</a>
<a class="sourceLine" id="cb4-3" title="3">sum<span class="op">$</span>cvm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span>(<span class="st">"+"</span>,<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(fit,<span class="cf">function</span>(x) x<span class="op">$</span>lasso1<span class="op">$</span>cvm))</a>
<a class="sourceLine" id="cb4-4" title="4">sum<span class="op">$</span>sigma.min &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(fit,<span class="cf">function</span>(x) x<span class="op">$</span>lasso1<span class="op">$</span>sigma.min)</a>
<a class="sourceLine" id="cb4-5" title="5">sum<span class="op">$</span>pi.min &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(fit,<span class="cf">function</span>(x) x<span class="op">$</span>lasso1<span class="op">$</span>pi.min)</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"manuscript/figure_MAP.pdf"</span>,<span class="dt">width=</span><span class="dv">4</span>,<span class="dt">height=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#grDevices::postscript("manuscript/figure_MAP.eps",horizontal=FALSE,onefile=FALSE,paper="special",width=4,height=3)</span></a>
<a class="sourceLine" id="cb4-9" title="9">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb4-10" title="10">cornet<span class="op">:::</span><span class="kw"><a href="../reference/plot.cornet.html">plot.cornet</a></span>(sum)</a>
<a class="sourceLine" id="cb4-11" title="11">grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>())</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#load("results/application.RData",verbose=TRUE)</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#sigma.min &lt;- sapply(fit,function(x) x$lasso1$sigma.min)</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#sigma.min &lt;- sapply(fit,function(x) sapply(x,function(x) x$sigma.min))</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#sigma &lt;- round(quantile(sigma.min,p=c(0,0.5,1)),digits=2)</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#cutoff &lt;- unique(sapply(fit,function(x) x$lasso1$cutoff))</span></a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8">sigma &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>); cutoff &lt;-<span class="st"> </span><span class="fl">25.5</span> <span class="co"># or actual values (see above)</span></a>
<a class="sourceLine" id="cb5-9" title="9">x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dt">from=</span><span class="dv">20</span>,<span class="dt">to=</span><span class="dv">30</span>,<span class="dt">length.out=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb5-10" title="10"></a>
<a class="sourceLine" id="cb5-11" title="11">grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="st">"manuscript/figure_TFN.pdf"</span>,<span class="dt">width=</span><span class="dv">4</span>,<span class="dt">height=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#grDevices::postscript("manuscript/figure_TFN.eps",horizontal=FALSE,onefile=FALSE,paper="special",width=4,height=3)</span></a>
<a class="sourceLine" id="cb5-13" title="13">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb5-14" title="14">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()</a>
<a class="sourceLine" id="cb5-15" title="15">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="dt">xlim=</span><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(x),<span class="dt">ylim=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-16" title="16">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>()</a>
<a class="sourceLine" id="cb5-17" title="17">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dt">side=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-18" title="18">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="dt">side=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-19" title="19">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="dt">xlab=</span><span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span>(y)),<span class="dt">ylab=</span><span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw">Phi</span>(<span class="kw"><a href="https://rdrr.io/r/stats/influence.measures.html">hat</a></span>(y),mu,sigma<span class="op">^</span><span class="dv">2</span>)),<span class="dt">line=</span><span class="fl">2.5</span>)</a>
<a class="sourceLine" id="cb5-20" title="20">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">h=</span><span class="fl">0.5</span>,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb5-21" title="21">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="dt">v=</span>cutoff,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">"grey"</span>)</a>
<a class="sourceLine" id="cb5-22" title="22"></a>
<a class="sourceLine" id="cb5-23" title="23">lty &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>); lwd &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-24" title="24">lty &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>,<span class="st">"solid"</span>,<span class="st">"dotted"</span>)</a>
<a class="sourceLine" id="cb5-25" title="25"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span>(sigma)){</a>
<a class="sourceLine" id="cb5-26" title="26">  p &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="dt">q=</span>x,<span class="dt">mean=</span>cutoff,<span class="dt">sd=</span>sigma[i])</a>
<a class="sourceLine" id="cb5-27" title="27">  graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="dt">x=</span>x,<span class="dt">y=</span>p,<span class="dt">lty=</span>lty[i],<span class="dt">lwd=</span>lwd[i])</a>
<a class="sourceLine" id="cb5-28" title="28">}</a>
<a class="sourceLine" id="cb5-29" title="29"></a>
<a class="sourceLine" id="cb5-30" title="30">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="dt">x=</span>cutoff,<span class="dt">y=</span><span class="fl">0.40</span>,<span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span>(mu<span class="op">==</span>.(cutoff)),<span class="dt">pos=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb5-31" title="31">legend &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(sigma,<span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/expression.html">as.expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span>(sigma <span class="op">==</span><span class="st"> </span>.(x))))</a>
<a class="sourceLine" id="cb5-32" title="32">graphics<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="dt">x=</span><span class="st">"topleft"</span>,<span class="dt">legend=</span>legend,<span class="dt">lty=</span>lty,<span class="dt">bty=</span><span class="st">"n"</span>,<span class="dt">lwd=</span>lwd)</a>
<a class="sourceLine" id="cb5-33" title="33">grDevices<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#processing">Processing</a></li>
      <li><a href="#analysis">Analysis</a></li>
      <li><a href="#results">Results</a></li>
      <li><a href="#figures">Figures</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://rauschenberger.github.io">Armin Rauschenberger</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
